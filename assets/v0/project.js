!function(){function e(t){(t||document).querySelectorAll(".project-player_wrap").forEach(function(t){if(t.__ppInit)return;t.__ppInit=1,t.dataset&&delete t.dataset.scriptInitialized;if(!document.body.contains(t))return void requestAnimationFrame(function(){e(document)});var n=t.querySelector(".project-player_stage")||t,r=n.getAttribute("data-project-slug")||t.getAttribute("data-project-slug")||"",o=n.getAttribute("data-video")||t.getAttribute("data-video")||"",i=n.getAttribute("data-captions")||t.getAttribute("data-captions")||"",a=n.getAttribute("data-poster")||t.getAttribute("data-poster")||"",l=n.querySelector(".project-player_video-host")||t.querySelector(".project-player_video-host");if(!l||!o)return;var s=t.querySelector('[data-role="play"]'),u=t.querySelector('[data-role="mute"]'),c=t.querySelector('[data-role="mute-label"]'),d=t.querySelector('[data-role="fs"]'),p=t.querySelector('[data-role="timeline"]'),y=t.querySelector(".project-player_timeline-buffer"),m=t.querySelector(".project-player_timeline-handle"),f=t.querySelector(".project-player_pausefx");if(f||(f=document.createElement("div"),f.className="project-player_pausefx u-cover-absolute u-inset-0",(t.querySelector(".project-player_stage")||t).appendChild(f)),!t.querySelector(".project-player_center-toggle")){var v=document.createElement("button");v.className="project-player_center-toggle project-player_btn project-player_btn--play",v.type="button",v.setAttribute("aria-pressed","false"),v.setAttribute("aria-label","Unmute"),v.style.color="#fff",v.innerHTML='<svg viewBox="0 0 24 24" class="pp-icon" aria-hidden="true" fill="none"><g class="pp-icon--group pp-icon--sound"><path d="M12 5V19L7 16H2V8H7L12 5Z"></path><path d="M19.3 19.3C21.0459 17.2685 22.0059 14.6786 22.0059 12C22.0059 9.3214 21.0459 6.73148 19.3 4.70001"></path><path d="M16.4 16.4C17.4429 15.1711 18.0154 13.6118 18.0154 12C18.0154 10.3882 17.4429 8.82888 16.4 7.60001"></path></g><g class="pp-icon--group pp-icon--play"><g class="pp-icon__part pp-icon__play"><path d="M5.2 12V3L13 7.5L20.8 12L13 16.5L5.2 21V12Z"></path></g><g class="pp-icon__part pp-icon__pause"><path d="M9.5 5.5H6.5V18.5H9.5V5.5Z"></path><path d="M17.5 5.5H14.5V18.5H17.5V5.5Z"></path></g></g></svg><span class="u-sr-only">Unmute</span>',(t.querySelector(".project-player_stage")||t).appendChild(v)}var h=l.querySelector("video");h||(h=document.createElement("video"),h.playsInline=!0,h.crossOrigin="anonymous",h.preload="auto",l.appendChild(h)),h.className="project-player_video",h.controls=!1,a&&(h.poster=a),(h.src||"")!==o&&(h.src=o,h.load()),i&&!h.querySelector('track[kind="subtitles"], track[kind="captions"]')&&function(e,t){var n=document.createElement("track");n.kind="subtitles",n.label="English",n.srclang="en",n.src=t,n.default=!1,e.appendChild(n)}(h,i),h.muted=!0,h.setAttribute("muted",""),h.volume=0;var b=0,g=!1,_=!1,w=t.querySelector(".project-player_center-toggle");function S(e){var t=e?"true":"false";s&&(s.setAttribute("aria-pressed",t),s.classList.toggle("is-playing",e)),w&&w.classList.contains("is-mode-play")&&(w.setAttribute("aria-pressed",t),w.classList.toggle("is-playing",e))}function E(e){u&&(u.setAttribute("aria-pressed",e?"true":"false"),c?c.textContent=e?"Sound":"Mute":u.textContent=e?"Sound":"Mute")}function L(e){t.classList.toggle("is-paused",!!e)}function T(e){t.dataset.idle=e?"1":"0"}function A(){clearTimeout(b),T(!1),b=setTimeout(function(){T(!0)},1800)}async function C(e){if(e.readyState<2){await new Promise(function(t){var n=function(){t()};e.addEventListener("loadeddata",n,{once:!0}),e.addEventListener("canplay",n,{once:!0}),setTimeout(n,3e3)})}try{"fastSeek"in e?e.fastSeek(0):e.currentTime=Math.max(1e-5,e.currentTime)}catch(e){}try{e.muted=!0,e.setAttribute("muted","");var t=e.play&&e.play();t&&t.then&&await t.catch(function(){})}catch(e){}await new Promise(function(t){var n=!1,r=setTimeout(function(){n||(n=!0,t())},800),o=function(){n||(n=!0,clearTimeout(r),e.removeEventListener("timeupdate",o),requestAnimationFrame(t))};e.addEventListener("timeupdate",o,{once:!0})})}function P(){if(isFinite(h.duration)){var e=h.currentTime/h.duration*100;m&&(m.style.left=e+"%"),p&&p.setAttribute("aria-valuenow",String(Math.round(e))),h.buffered&&h.buffered.length&&y&&(e=h.buffered.end(h.buffered.length-1),y.style.width=Math.min(100,e/h.duration*100)+"%")}}function q(){P(),requestAnimationFrame(q)}function M(e){isFinite(h.duration)&&(e=Math.max(0,Math.min(100,e)),h.currentTime=e/100*h.duration,P())}function k(){w.classList.add("is-mode-play"),w.setAttribute("aria-label","Play/Pause");var e=!h.paused;w.classList.toggle("is-playing",e),w.setAttribute("aria-pressed",e?"true":"false")}async function x(){try{if(h.paused){if(h.muted||0===h.volume){h.muted=!1,h.removeAttribute("muted");var e=Number(localStorage.getItem("pp:vol")||1)||1;h.volume=e,E(!1),_=!0}await h.play()}else await h.pause()}catch(e){}S(!h.paused),L(h.paused),A()}s&&s.addEventListener("click",x),w&&w.addEventListener("click",async function(){if(w.classList.contains("is-mode-play"))await x();else{try{h.muted=!1,h.removeAttribute("muted");var e=Number(localStorage.getItem("pp:vol")||1)||1;h.volume=e;try{"fastSeek"in h?h.fastSeek(0):h.currentTime=0}catch(e){try{h.currentTime=0}catch(e){}}await(h.play&&h.play()),k(),E(!1),S(!0),L(!1),_=!0}catch(e){}A()}}),u&&u.addEventListener("click",async function(){var e=h.muted;if(h.muted=!h.muted,h.muted)h.setAttribute("muted","");else{h.removeAttribute("muted"),0===h.volume&&(h.volume=Number(localStorage.getItem("pp:vol")||1)||1),e&&!_&&(_=!0,try{"fastSeek"in h?h.fastSeek(0):h.currentTime=0}catch(e){try{h.currentTime=0}catch(e){}}try{await(h.play&&h.play())}catch(e){}S(!0),L(!1),k())}localStorage.setItem("pp:muted",h.muted?"1":"0"),E(h.muted),A()}),document.addEventListener("fullscreenchange",function(){if(d){var e=!!document.fullscreenElement&&(document.fullscreenElement===t||t.contains(document.fullscreenElement));d.textContent=e?"Minimise":"Fullscreen",d.setAttribute("aria-label",e?"Exit fullscreen":"Toggle fullscreen")}}),d&&d.addEventListener("click",async function(){try{document.fullscreenElement?await(document.exitFullscreen&&document.exitFullscreen()):await(t.requestFullscreen&&t.requestFullscreen())}catch(e){}A()}),p&&(p.addEventListener("pointerdown",function(e){g=!0,p.setPointerCapture&&p.setPointerCapture(e.pointerId);var t=p.getBoundingClientRect();M((e.clientX-t.left)/t.width*100),A()}),p.addEventListener("pointermove",function(e){if(g){var t=p.getBoundingClientRect();M((e.clientX-t.left)/t.width*100)}}),p.addEventListener("pointerup",function(){g=!1}),p.addEventListener("pointercancel",function(){g=!1}),p.addEventListener("keydown",function(e){var t=e.shiftKey?10:5,n=Number(p.getAttribute("aria-valuenow")||0);"ArrowRight"===e.key&&(M(n+t),e.preventDefault()),"ArrowLeft"===e.key&&(M(n-t),e.preventDefault())})),["mousemove","pointermove","touchstart","keydown"].forEach(function(e){t.addEventListener(e,A,{passive:!0})}),A(),(async function(){await C(h);try{await(h.play&&h.play())}catch(e){}S(!h.paused),L(h.paused);var e=function(e){try{var t=JSON.parse(sessionStorage.getItem("videoIntent")||"null");return t&&(!e||t.slug===e)&&Date.now()-t.t<1e4?t:null}catch(e){return null}}(r);if(e&&e.withSound)try{h.muted=!1,h.removeAttribute("muted"),h.volume=Number(localStorage.getItem("pp:vol")||1)||1,await(h.play&&h.play()),E(!1),_=!0,L(!1),k()}catch(e){E(!0)}else w&&(w.classList.remove("is-mode-play"),w.setAttribute("aria-label","Unmute"),E(!0));requestAnimationFrame(function(){requestAnimationFrame(function(){P()})}),requestAnimationFrame(q)})(),h.addEventListener("play",function(){S(!0),L(!1)}),h.addEventListener("playing",function(){L(!1)}),h.addEventListener("pause",function(){S(!1),L(!0)}),h.addEventListener("ended",function(){S(!1),L(!0)}),h.addEventListener("timeupdate",function(){g||P()});var O=new MutationObserver(function(){if(!document.body.contains(t))try{cancelAnimationFrame(b),h.pause(),h.muted=!0}catch(e){}O.disconnect()});O.observe(document.body,{childList:!0,subtree:!0})})}document.addEventListener("DOMContentLoaded",function(){e(document)}),document.addEventListener("page:enter",function(t){var n=t&&t.detail&&t.detail.container||document;requestAnimationFrame(function(){e(n)})})}();
