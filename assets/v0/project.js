!function(){function e(t){(t||document).querySelectorAll(".project-player_wrap").forEach(function(t){if(!t.dataset.scriptInitialized){t.dataset.scriptInitialized="true";var e=t.querySelector(".project-player_stage")||t,n=e.getAttribute("data-project-slug")||t.getAttribute("data-project-slug")||"",a=e.getAttribute("data-video")||t.getAttribute("data-video")||"",o=e.getAttribute("data-captions")||t.getAttribute("data-captions")||"",r=e.getAttribute("data-poster")||t.getAttribute("data-poster")||"",i=e.querySelector(".project-player_video-host")||t.querySelector(".project-player_video-host");if(i&&a){var d=t.querySelector('[data-role="play"]'),l=t.querySelector('[data-role="mute"]'),u=t.querySelector('[data-role="mute-label"]'),c=t.querySelector('[data-role="fs"]'),s=t.querySelector('[data-role="timeline"]'),p=t.querySelector(".project-player_timeline-buffer"),y=t.querySelector(".project-player_timeline-handle"),m=t.querySelector(".project-player_pausefx");if(m||(m=document.createElement("div"),m.className="project-player_pausefx u-cover-absolute u-inset-0",(t.querySelector(".project-player_stage")||t).querySelector(".project-player_video-host")?.nextSibling?(t.querySelector(".project-player_stage")||t).insertBefore(m,(t.querySelector(".project-player_stage")||t).querySelector(".project-player_video-host").nextSibling):(t.querySelector(".project-player_stage")||t).appendChild(m)),!t.querySelector(".project-player_center-toggle")){var f=document.createElement("button");f.className="project-player_center-toggle project-player_btn project-player_btn--play",f.type="button",f.setAttribute("aria-pressed","false"),f.setAttribute("aria-label","Unmute"),f.style.color="#fff",f.innerHTML='<svg viewBox="0 0 24 24" class="pp-icon" aria-hidden="true" fill="none"><g class="pp-icon--group pp-icon--sound"><path d="M12 5V19L7 16H2V8H7L12 5Z"></path><path d="M19.3 19.3C21.0459 17.2685 22.0059 14.6786 22.0059 12C22.0059 9.3214 21.0459 6.73148 19.3 4.70001"></path><path d="M16.4 16.4C17.4429 15.1711 18.0154 13.6118 18.0154 12C18.0154 10.3882 17.4429 8.82888 16.4 7.60001"></path></g><g class="pp-icon--group pp-icon--play"><g class="pp-icon__part pp-icon__play"><path d="M5.2 12V3L13 7.5L20.8 12L13 16.5L5.2 21V12Z"></path></g><g class="pp-icon__part pp-icon__pause"><path d="M9.5 5.5H6.5V18.5H9.5V5.5Z"></path><path d="M17.5 5.5H14.5V18.5H17.5V5.5Z"></path></g></g></svg><span class="u-sr-only">Unmute</span>',(t.querySelector(".project-player_stage")||t).appendChild(f)}var v=i.querySelector("video");v||(v=document.createElement("video"),v.playsInline=!0,v.crossOrigin="anonymous",v.preload="auto",v.src=a),o&&!v.querySelector('track[kind="subtitles"], track[kind="captions"]')&&function(t,e){var n=document.createElement("track");n.kind="subtitles",n.label="English",n.srclang="en",n.src=e,n.default=!1,t.appendChild(n)}(v,o),v.className="project-player_video",v.controls=!1,r&&(v.poster=r),v.isConnected||i.appendChild(v),v.muted=!0,v.setAttribute("muted",""),v.volume=0;var h=0,g=!1,b=0,_=!1,w=t.querySelector(".project-player_center-toggle");function S(t){var e=t?"true":"false";d&&(d.setAttribute("aria-pressed",e),d.classList.toggle("is-playing",t)),w&&w.classList.contains("is-mode-play")&&(w.setAttribute("aria-pressed",e),w.classList.toggle("is-playing",t))}function E(t){l&&(l.setAttribute("aria-pressed",t?"true":"false"),u?u.textContent=t?"Sound":"Mute":l.textContent=t?"Sound":"Mute")}function L(e){t.classList.toggle("is-paused",!!e)}function T(e){t.dataset.idle=e?"1":"0"}function C(){clearTimeout(b),T(!1),b=setTimeout(function(){T(!0)},1800)}function A(t){try{var e=JSON.parse(sessionStorage.getItem("videoIntent")||"null");return e&&(!t||e.slug===t)&&Date.now()-e.t<1e4?e:null}catch(t){return null}}async function P(t){t.readyState<2&&await new Promise(function(e){var n=function(){e()};t.addEventListener("loadeddata",n,{once:!0}),t.addEventListener("canplay",n,{once:!0}),setTimeout(n,3e3)});try{"fastSeek"in t?t.fastSeek(0):t.currentTime=Math.max(1e-5,t.currentTime)}catch(t){}try{t.muted=!0,t.setAttribute("muted","");var e=t.play&&t.play();e&&e.then&&await e.catch(function(){})}catch(t){}await new Promise(function(e){var n=!1,a=setTimeout(function(){n||(n=!0,e())},800),o=function(){n||(n=!0,clearTimeout(a),t.removeEventListener("timeupdate",o),requestAnimationFrame(e))};t.addEventListener("timeupdate",o,{once:!0})})}function q(){if(isFinite(v.duration)){var t=v.currentTime/v.duration*100;y&&(y.style.left=t+"%"),s&&s.setAttribute("aria-valuenow",String(Math.round(t))),v.buffered&&v.buffered.length&&p&&(t=v.buffered.end(v.buffered.length-1),p.style.width=Math.min(100,t/v.duration*100)+"%")}}function M(){q(),h=requestAnimationFrame(M)}function k(t){isFinite(v.duration)&&(t=Math.max(0,Math.min(100,t)),v.currentTime=t/100*v.duration,q())}function x(){w.classList.add("is-mode-play"),w.setAttribute("aria-label","Play/Pause");var t=!v.paused;w.classList.toggle("is-playing",t),w.setAttribute("aria-pressed",t?"true":"false")}async function D(){try{if(v.paused){if(v.muted||0===v.volume){v.muted=!1,v.removeAttribute("muted");var t=Number(localStorage.getItem("pp:vol")||1)||1;v.volume=t,E(!1),_=!0}await v.play()}else await v.pause()}catch(t){}S(!v.paused),L(v.paused),C()}d&&d.addEventListener("click",D),w.addEventListener("click",async function(){if(w.classList.contains("is-mode-play"))await D();else{try{v.muted=!1,v.removeAttribute("muted");var t=Number(localStorage.getItem("pp:vol")||1)||1;v.volume=t;try{"fastSeek"in v?v.fastSeek(0):v.currentTime=0}catch(t){try{v.currentTime=0}catch(t){}}await(v.play&&v.play()),x(),E(!1),S(!0),L(!1),_=!0}catch(t){}C()}}),l&&l.addEventListener("click",async function(){var t=v.muted;if(v.muted=!v.muted,v.muted)v.setAttribute("muted","");else if(v.removeAttribute("muted"),0===v.volume){var e=Number(localStorage.getItem("pp:vol")||1)||1;v.volume=e}t&&!_&&(_=!0,try{"fastSeek"in v?v.fastSeek(0):v.currentTime=0}catch(t){try{v.currentTime=0}catch(t){}}try{await(v.play&&v.play())}catch(t){}S(!0),L(!1),x()),localStorage.setItem("pp:muted",v.muted?"1":"0"),E(v.muted),C()}),document.addEventListener("fullscreenchange",function(){if(c){var e=!!document.fullscreenElement&&(document.fullscreenElement===t||t.contains(document.fullscreenElement));c.textContent=e?"Minimise":"Fullscreen",c.setAttribute("aria-label",e?"Exit fullscreen":"Toggle fullscreen")}}),c&&c.addEventListener("click",async function(){try{document.fullscreenElement?await(document.exitFullscreen&&document.exitFullscreen()):await(t.requestFullscreen&&t.requestFullscreen())}catch(t){}C()}),s&&(s.addEventListener("pointerdown",function(t){g=!0,s.setPointerCapture&&s.setPointerCapture(t.pointerId);var e=s.getBoundingClientRect();k((t.clientX-e.left)/e.width*100),C()}),s.addEventListener("pointermove",function(t){if(g){var e=s.getBoundingClientRect();k((t.clientX-e.left)/e.width*100)}}),s.addEventListener("pointerup",function(){g=!1}),s.addEventListener("pointercancel",function(){g=!1}),s.addEventListener("keydown",function(t){var e=t.shiftKey?10:5,n=Number(s.getAttribute("aria-valuenow")||0);"ArrowRight"===t.key&&(k(n+e),t.preventDefault()),"ArrowLeft"===t.key&&(k(n-e),t.preventDefault())})),["mousemove","pointermove","touchstart","keydown"].forEach(function(e){t.addEventListener(e,C,{passive:!0})}),C(),async function(){await P(v);try{await(v.play&&v.play())}catch(t){}S(!v.paused),L(v.paused);var t=A(n);if(t&&t.withSound)try{v.muted=!1,v.removeAttribute("muted");var e=Number(localStorage.getItem("pp:vol")||1)||1;v.volume=e,await(v.play&&v.play()),E(!1),_=!0,L(!1),x()}catch(t){E(!0)}else w.classList.remove("is-mode-play"),w.setAttribute("aria-label","Unmute"),E(!0);requestAnimationFrame(function(){requestAnimationFrame(function(){q()})}),h=requestAnimationFrame(M),function(){if(!c)return;var e=!!document.fullscreenElement&&(document.fullscreenElement===t||t.contains(document.fullscreenElement));c.textContent=e?"Minimise":"Fullscreen",c.setAttribute("aria-label",e?"Exit fullscreen":"Toggle fullscreen")}()}(),v.addEventListener("play",function(){S(!0),L(!1)}),v.addEventListener("playing",function(){L(!1)}),v.addEventListener("pause",function(){S(!1),L(!0)}),v.addEventListener("ended",function(){S(!1),L(!0)}),v.addEventListener("timeupdate",function(){g||q()});var O=new MutationObserver(function(){if(!document.body.contains(t))try{cancelAnimationFrame(h),b&&v.cancelVideoFrameCallback&&v.cancelVideoFrameCallback(b),v.pause(),v.muted=!0}catch(t){}O.disconnect()});O.observe(document.body,{childList:!0,subtree:!0})}}})}document.addEventListener("DOMContentLoaded",function(){e(document)}),document.addEventListener("page:enter",function(t){e(t&&t.detail&&t.detail.container||document)})}();
